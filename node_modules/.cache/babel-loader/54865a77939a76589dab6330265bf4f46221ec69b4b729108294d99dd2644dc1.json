{"ast":null,"code":"var _jsxFileName = \"/home/thang/Documents/tmdt/ecommerce/frontend/src/components/ui/buttons/AddToCart/AddToCart.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { Button, CircularProgress, Snackbar, Alert } from \"@mui/material\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { useAuth } from \"../../../../context/AuthContext\";\nimport { useCart } from \"../../../../context/CartContext\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function AddToCart({\n  product,\n  size,\n  color\n}) {\n  _s();\n  const {\n    isLoggedIn\n  } = useAuth();\n  const {\n    addToCart\n  } = useCart();\n  const navigate = useNavigate();\n  const {\n    t\n  } = useTranslation();\n  const [loading, setLoading] = useState(false);\n  const [snackbar, setSnackbar] = useState({\n    open: false,\n    message: \"\",\n    severity: \"success\"\n  });\n  async function handleAddToCart() {\n    // Prevent double-click\n    if (loading) return;\n    if (!isLoggedIn) {\n      navigate(\"/login\");\n      return;\n    }\n    if (!size) {\n      setSnackbar({\n        open: true,\n        message: t(\"product.select_size\") || \"Please select a size\",\n        severity: \"error\"\n      });\n      return;\n    }\n    try {\n      setLoading(true);\n      await addToCart({\n        product_id: product.id,\n        size: size,\n        quantity: 1\n      }, {\n        name: product.product_name,\n        image: product.image_url,\n        slug: product.slug || \"\"\n      });\n      setSnackbar({\n        open: true,\n        message: t(\"cart.item_added\"),\n        severity: \"success\"\n      });\n    } catch (err) {\n      var _err$response, _err$response$data;\n      let message = t(\"common.error\");\n      const detail = (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail;\n      if (typeof detail === \"string\") {\n        message = detail;\n      } else if (Array.isArray(detail) && detail.length > 0) {\n        // FastAPI validation error format: [{type, loc, msg, input}]\n        message = detail.map(e => e.msg).join(\", \");\n      }\n      setSnackbar({\n        open: true,\n        message,\n        severity: \"error\"\n      });\n    } finally {\n      setLoading(false);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [product ? /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      onClick: handleAddToCart,\n      disabled: loading,\n      sx: {\n        bgcolor: \"#1a1a1a\",\n        \"&:hover\": {\n          bgcolor: \"#333\"\n        },\n        py: 1.5,\n        px: 4,\n        fontWeight: 600\n      },\n      children: loading ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n        size: 24,\n        color: \"inherit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 22\n      }, this) : t(\"product.add_to_cart\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      disabled: true,\n      children: t(\"product.out_of_stock\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n      open: snackbar.open,\n      autoHideDuration: 3000,\n      onClose: () => setSnackbar({\n        ...snackbar,\n        open: false\n      }),\n      anchorOrigin: {\n        vertical: \"bottom\",\n        horizontal: \"center\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        severity: snackbar.severity,\n        onClose: () => setSnackbar({\n          ...snackbar,\n          open: false\n        }),\n        children: snackbar.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(AddToCart, \"WEhvfkryodLOyR9/Nct5mEgQLI8=\", false, function () {\n  return [useAuth, useCart, useNavigate, useTranslation];\n});\n_c = AddToCart;\nvar _c;\n$RefreshReg$(_c, \"AddToCart\");","map":{"version":3,"names":["React","useState","Button","CircularProgress","Snackbar","Alert","useNavigate","useTranslation","useAuth","useCart","jsxDEV","_jsxDEV","Fragment","_Fragment","AddToCart","product","size","color","_s","isLoggedIn","addToCart","navigate","t","loading","setLoading","snackbar","setSnackbar","open","message","severity","handleAddToCart","product_id","id","quantity","name","product_name","image","image_url","slug","err","_err$response","_err$response$data","detail","response","data","Array","isArray","length","map","e","msg","join","children","variant","onClick","disabled","sx","bgcolor","py","px","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","autoHideDuration","onClose","anchorOrigin","vertical","horizontal","_c","$RefreshReg$"],"sources":["/home/thang/Documents/tmdt/ecommerce/frontend/src/components/ui/buttons/AddToCart/AddToCart.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Button, CircularProgress, Snackbar, Alert } from \"@mui/material\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { Product } from \"../../../../types/types\";\nimport { useAuth } from \"../../../../context/AuthContext\";\nimport { useCart } from \"../../../../context/CartContext\";\n\ninterface IAddToCart {\n  product: Product;\n  size: string;\n  color: string;\n}\n\nexport default function AddToCart({ product, size, color }: IAddToCart) {\n  const { isLoggedIn } = useAuth();\n  const { addToCart } = useCart();\n  const navigate = useNavigate();\n  const { t } = useTranslation();\n  const [loading, setLoading] = useState(false);\n  const [snackbar, setSnackbar] = useState<{ open: boolean; message: string; severity: \"success\" | \"error\" }>({\n    open: false,\n    message: \"\",\n    severity: \"success\",\n  });\n\n  async function handleAddToCart() {\n    // Prevent double-click\n    if (loading) return;\n\n    if (!isLoggedIn) {\n      navigate(\"/login\");\n      return;\n    }\n\n    if (!size) {\n      setSnackbar({ open: true, message: t(\"product.select_size\") || \"Please select a size\", severity: \"error\" });\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await addToCart(\n        {\n          product_id: product.id,\n          size: size,\n          quantity: 1,\n        },\n        {\n          name: product.product_name,\n          image: product.image_url,\n          slug: product.slug || \"\",\n        }\n      );\n      setSnackbar({ open: true, message: t(\"cart.item_added\"), severity: \"success\" });\n    } catch (err: any) {\n      let message = t(\"common.error\");\n      const detail = err.response?.data?.detail;\n      if (typeof detail === \"string\") {\n        message = detail;\n      } else if (Array.isArray(detail) && detail.length > 0) {\n        // FastAPI validation error format: [{type, loc, msg, input}]\n        message = detail.map((e: any) => e.msg).join(\", \");\n      }\n      setSnackbar({ open: true, message, severity: \"error\" });\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <>\n      {product ? (\n        <Button\n          variant=\"contained\"\n          onClick={handleAddToCart}\n          disabled={loading}\n          sx={{\n            bgcolor: \"#1a1a1a\",\n            \"&:hover\": { bgcolor: \"#333\" },\n            py: 1.5,\n            px: 4,\n            fontWeight: 600,\n          }}\n        >\n          {loading ? <CircularProgress size={24} color=\"inherit\" /> : t(\"product.add_to_cart\")}\n        </Button>\n      ) : (\n        <Button variant=\"contained\" disabled>\n          {t(\"product.out_of_stock\")}\n        </Button>\n      )}\n      <Snackbar\n        open={snackbar.open}\n        autoHideDuration={3000}\n        onClose={() => setSnackbar({ ...snackbar, open: false })}\n        anchorOrigin={{ vertical: \"bottom\", horizontal: \"center\" }}\n      >\n        <Alert severity={snackbar.severity} onClose={() => setSnackbar({ ...snackbar, open: false })}>\n          {snackbar.message}\n        </Alert>\n      </Snackbar>\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}