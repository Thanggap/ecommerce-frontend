{"ast":null,"code":"var _jsxFileName = \"/home/thang/Documents/tmdt/ecommerce/frontend/src/components/ui/buttons/AddToCart/AddToCart.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { Button, CircularProgress, Snackbar, Alert } from \"@mui/material\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { addToCart as addToCartAPI } from \"../../../../services/Cart\";\nimport { useAuth } from \"../../../../context/AuthContext\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function AddToCart({\n  product,\n  size,\n  color\n}) {\n  _s();\n  const {\n    isLoggedIn\n  } = useAuth();\n  const navigate = useNavigate();\n  const {\n    t\n  } = useTranslation();\n  const [loading, setLoading] = useState(false);\n  const [snackbar, setSnackbar] = useState({\n    open: false,\n    message: \"\",\n    severity: \"success\"\n  });\n  async function handleAddToCart() {\n    // Prevent double-click\n    if (loading) return;\n    if (!isLoggedIn) {\n      navigate(\"/login\");\n      return;\n    }\n    if (!size) {\n      setSnackbar({\n        open: true,\n        message: t(\"product.select_size\") || \"Please select a size\",\n        severity: \"error\"\n      });\n      return;\n    }\n    try {\n      setLoading(true);\n      await addToCartAPI({\n        product_id: product.id,\n        size: size,\n        quantity: 1\n      });\n      setSnackbar({\n        open: true,\n        message: t(\"cart.item_added\"),\n        severity: \"success\"\n      });\n    } catch (err) {\n      var _err$response, _err$response$data;\n      let message = t(\"common.error\");\n      const detail = (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail;\n      if (typeof detail === \"string\") {\n        message = detail;\n      } else if (Array.isArray(detail) && detail.length > 0) {\n        // FastAPI validation error format: [{type, loc, msg, input}]\n        message = detail.map(e => e.msg).join(\", \");\n      }\n      setSnackbar({\n        open: true,\n        message,\n        severity: \"error\"\n      });\n    } finally {\n      setLoading(false);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [product ? /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      onClick: handleAddToCart,\n      disabled: loading,\n      sx: {\n        bgcolor: \"#1a1a1a\",\n        \"&:hover\": {\n          bgcolor: \"#333\"\n        },\n        py: 1.5,\n        px: 4,\n        fontWeight: 600\n      },\n      children: loading ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n        size: 24,\n        color: \"inherit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 22\n      }, this) : t(\"product.add_to_cart\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      disabled: true,\n      children: t(\"product.out_of_stock\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n      open: snackbar.open,\n      autoHideDuration: 3000,\n      onClose: () => setSnackbar({\n        ...snackbar,\n        open: false\n      }),\n      anchorOrigin: {\n        vertical: \"bottom\",\n        horizontal: \"center\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        severity: snackbar.severity,\n        onClose: () => setSnackbar({\n          ...snackbar,\n          open: false\n        }),\n        children: snackbar.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(AddToCart, \"/F42LjRkyKYtWqTweJC7auBOIcc=\", false, function () {\n  return [useAuth, useNavigate, useTranslation];\n});\n_c = AddToCart;\nvar _c;\n$RefreshReg$(_c, \"AddToCart\");","map":{"version":3,"names":["React","useState","Button","CircularProgress","Snackbar","Alert","useNavigate","useTranslation","addToCart","addToCartAPI","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","AddToCart","product","size","color","_s","isLoggedIn","navigate","t","loading","setLoading","snackbar","setSnackbar","open","message","severity","handleAddToCart","product_id","id","quantity","err","_err$response","_err$response$data","detail","response","data","Array","isArray","length","map","e","msg","join","children","variant","onClick","disabled","sx","bgcolor","py","px","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","autoHideDuration","onClose","anchorOrigin","vertical","horizontal","_c","$RefreshReg$"],"sources":["/home/thang/Documents/tmdt/ecommerce/frontend/src/components/ui/buttons/AddToCart/AddToCart.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Button, CircularProgress, Snackbar, Alert } from \"@mui/material\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { Product } from \"../../../../types/types\";\nimport { addToCart as addToCartAPI } from \"../../../../services/Cart\";\nimport { useAuth } from \"../../../../context/AuthContext\";\n\ninterface IAddToCart {\n  product: Product;\n  size: string;\n  color: string;\n}\n\nexport default function AddToCart({ product, size, color }: IAddToCart) {\n  const { isLoggedIn } = useAuth();\n  const navigate = useNavigate();\n  const { t } = useTranslation();\n  const [loading, setLoading] = useState(false);\n  const [snackbar, setSnackbar] = useState<{ open: boolean; message: string; severity: \"success\" | \"error\" }>({\n    open: false,\n    message: \"\",\n    severity: \"success\",\n  });\n\n  async function handleAddToCart() {\n    // Prevent double-click\n    if (loading) return;\n\n    if (!isLoggedIn) {\n      navigate(\"/login\");\n      return;\n    }\n\n    if (!size) {\n      setSnackbar({ open: true, message: t(\"product.select_size\") || \"Please select a size\", severity: \"error\" });\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await addToCartAPI({\n        product_id: product.id,\n        size: size,\n        quantity: 1,\n      });\n      setSnackbar({ open: true, message: t(\"cart.item_added\"), severity: \"success\" });\n    } catch (err: any) {\n      let message = t(\"common.error\");\n      const detail = err.response?.data?.detail;\n      if (typeof detail === \"string\") {\n        message = detail;\n      } else if (Array.isArray(detail) && detail.length > 0) {\n        // FastAPI validation error format: [{type, loc, msg, input}]\n        message = detail.map((e: any) => e.msg).join(\", \");\n      }\n      setSnackbar({ open: true, message, severity: \"error\" });\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <>\n      {product ? (\n        <Button\n          variant=\"contained\"\n          onClick={handleAddToCart}\n          disabled={loading}\n          sx={{\n            bgcolor: \"#1a1a1a\",\n            \"&:hover\": { bgcolor: \"#333\" },\n            py: 1.5,\n            px: 4,\n            fontWeight: 600,\n          }}\n        >\n          {loading ? <CircularProgress size={24} color=\"inherit\" /> : t(\"product.add_to_cart\")}\n        </Button>\n      ) : (\n        <Button variant=\"contained\" disabled>\n          {t(\"product.out_of_stock\")}\n        </Button>\n      )}\n      <Snackbar\n        open={snackbar.open}\n        autoHideDuration={3000}\n        onClose={() => setSnackbar({ ...snackbar, open: false })}\n        anchorOrigin={{ vertical: \"bottom\", horizontal: \"center\" }}\n      >\n        <Alert severity={snackbar.severity} onClose={() => setSnackbar({ ...snackbar, open: false })}>\n          {snackbar.message}\n        </Alert>\n      </Snackbar>\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}